{% extends "back/base.html" %}
{% block content %}
<div class="container py-4">

  <!-- Tambah Blog -->
  <a href="{% url 'tambah_blog' %}" class="btn btn-success mb-3">
    <i class="fas fa-plus"></i> Tambah Blog
  </a>

  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h5 class="mb-0"><i class="fas fa-newspaper me-2"></i>Daftar Blog</h5>
    </div>
    <div class="card-body">
      {% if blogs %}
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-primary">
            <tr>
              <th style="width: 5%;">No</th>
              <th style="width: 20%;">Judul</th>
              <th>Isi (Ringkas)</th>
              <th style="width: 10%;">Gambar</th>
              <th style="width: 15%;">Aksi</th>
            </tr>
          </thead>
          <tbody>
            {% for blog in blogs %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ blog.judul }}</td>
              <td>{{ blog.isi|truncatewords:15 }}</td>
              <td>
                {% if blog.gambar %}
                  <img src="{{ blog.gambar.url }}" alt="gambar" style="max-height: 60px;">
                {% else %}
                  -
                {% endif %}
              </td>
              <td>
                <a href="{% url 'edit_blog' blog.id %}" class="btn btn-warning btn-sm me-1">
                  <i class="fas fa-edit"></i>
                </a>

                <!-- Tombol modal hapus -->
                <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#hapusModal{{ blog.id }}">
                  <i class="fas fa-trash-alt"></i>
                </button>

                <!-- Modal hapus -->
                <div class="modal fade" id="hapusModal{{ blog.id }}" tabindex="-1" aria-labelledby="hapusModalLabel{{ blog.id }}" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <form method="post" action="{% url 'hapus_blog' blog.id %}">
                        {% csrf_token %}
                        <div class="modal-header">
                          <h5 class="modal-title" id="hapusModalLabel{{ blog.id }}">Konfirmasi Hapus</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          Apakah Anda yakin ingin menghapus blog <strong>{{ blog.judul }}</strong>?
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                          <button type="submit" class="btn btn-danger">Hapus</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>

              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <p class="text-muted">Belum ada blog.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
